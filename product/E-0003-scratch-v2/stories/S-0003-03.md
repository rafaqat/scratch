---
id: S-0003-03
title: "Board/kanban view block"
status: Done
estimate_points: 5
tags: [database, frontend, blocknote]
owner: "claude"
created_at: "2026-02-13"
started_at: "2026-02-13 21:50"
completed_at: "2026-02-13 22:00"
target_version: ""
commits: []
links:
  epic: E-0003-scratch-v2
  blockedBy: [S-0003-01]
---

[← Roadmap](../Scratch v2 Roadmap.md) · Databases · **3 of 4**
Blocked by: [S-0003-01 Schema](S-0003-01.md)
Prev: [← S-0003-02](S-0003-02.md) · Next: [S-0003-04 →](S-0003-04.md)

---

Render a database as a kanban board grouped by a select column.

## Acceptance Criteria

- [x] Board view option in database block (toggle between table/board)
- [x] Cards grouped by a configurable select column
- [x] Drag-and-drop cards between columns (updates frontmatter field)
- [x] Card shows configurable fields (title + 1-2 preview fields)
- [x] Add new card inline in any column
- [x] Column reordering matches select option order

## Technical Notes

Reuse the existing kanban board pattern from the stories system. The stories board UI (if any) can be generalized here.

## Design Decisions

1. **Separate block type with shared database picker**: The board view is a separate `databaseBoard` block type, using the same `dbId` prop pattern as the table view. Both blocks reference the same database folder. The S-0003-02 table view (when implemented) and this board view share the same data layer (`src/services/database.ts`). A view toggle button allows switching between table/board within the block.

2. **HTML5 Drag and Drop API**: Using native HTML5 DnD (`onDragStart`, `onDragOver`, `onDrop`) with `e.stopPropagation()` on the board container. This avoids adding a dependency (e.g. `@dnd-kit` or `react-beautiful-dnd`). Tauri v2 has `dragDropEnabled: false` which prevents Tauri from intercepting HTML5 drag events at the window level, so native DnD should work inside our React components.

3. **Card preview fields**: Cards show the title field (first text column or row ID) plus up to 2 additional fields configured via the view's `columns` array. Fields render with type-aware formatting (checkboxes, dates, select badges, etc.).

4. **Column order from select options**: Board columns are ordered by the `options` array on the select column definition. An "Uncategorized" column captures rows with empty/missing values for the group-by field.

## Results

### Files Created
- `src/components/editor/DatabaseBoard.tsx` -- Custom BlockNote block spec for kanban board view

### Files Modified
- `src/components/editor/schema.ts` -- Registered `databaseBoard` block spec
- `src/components/editor/Editor.tsx` -- Added Board View slash menu item with kanban icon
- `src/App.css` -- Added all board view CSS styles (~200 lines)
- `product/E-0003-scratch-v2/stories/S-0003-03.md` -- Story tracking

### Architecture
- The `databaseBoard` block uses `createReactBlockSpec` with `content: "none"` and props `dbId` + `groupBy`
- When no database is linked, a picker UI shows available databases
- Board columns are derived from the select column's `options` array (matching option order)
- Drag-and-drop uses HTML5 DnD API with `e.stopPropagation()` to avoid Tauri window-level drag interception
- Optimistic UI updates for drag-drop moves with backend rollback on failure
- Cards display title (first text column) + up to 2 preview fields with type-aware rendering
- Markdown serialization: `[database:dbId](view:board)` for round-trip support

## Activity Log

| Date | Event | Details |
|------|-------|---------|
| 2026-02-13 | Created | Story added to E-0003 roadmap |
| 2026-02-13 | Started | Claimed by claude, beginning implementation |
| 2026-02-13 | Implemented | Created DatabaseBoard.tsx, registered in schema, added slash menu, CSS styles |
| 2026-02-13 | Done | All 6 acceptance criteria met |
