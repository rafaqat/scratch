---
id: S-0003-11
title: "Template system"
status: Done
estimate_points: 3
tags: [templates, frontend, backend]
owner: "claude"
created_at: "2026-02-13"
started_at: "2026-02-13 21:34"
completed_at: "2026-02-13 21:50"
target_version: ""
commits: []
links:
  epic: E-0003-scratch-v2
  blocks: [S-0003-12]
---

[← Roadmap](../README.md) · Templates · **1 of 2**
Blocks: [S-0003-12 Database templates](S-0003-12.md)
Prev feature: [← S-0003-10](S-0003-10.md) · Next: [S-0003-12 →](S-0003-12.md)

---

Note templates stored as markdown files with variable substitution.

## Acceptance Criteria

- [x] Templates stored in `.scratch/templates/*.md`
- [x] "New from template" option in command palette (`Cmd+P`)
- [x] "New from template" in new-note dropdown/context menu
- [x] Variable substitution: `{{date}}`, `{{date:YYYY-MM-DD}}`, `{{title}}`, `{{time}}`
- [x] `{{cursor}}` marks initial cursor position after creation
- [x] Ship 3 built-in templates: Daily Journal, Meeting Notes, Project Brief
- [x] Users can create/edit templates (they're just markdown files)

## Technical Notes

Templates are plain markdown files — no special runtime needed. On "new from template": read template, substitute variables, create note, place cursor. Command palette already supports custom commands — add template list as a command group.

## Results

### Backend (Rust)
- Added `TemplateInfo` struct with id, name, description, is_builtin fields
- Added 3 built-in templates (Daily Journal, Meeting Notes, Project Brief) as embedded constants
- `ensure_templates_dir()` creates `.scratch/templates/` and writes built-in templates on first access
- Template variable engine supports `{{date}}`, `{{date:FORMAT}}`, `{{time}}`, `{{title}}`, `{{cursor}}`
- Custom date formatting with YYYY, MM, DD, MMMM, MMM, D patterns (no chrono dependency)
- `{{cursor}}` position tracked and returned as `cursor_line` for frontend cursor placement
- Three new Tauri commands: `list_templates`, `read_template`, `create_note_from_template`
- `create_note_from_template` performs variable substitution, creates note file, indexes in Tantivy

### Frontend (React/TypeScript)
- New `src/services/templates.ts` service layer wrapping Tauri template commands
- `NotesContext` extended with `createNoteFromTemplate` action and `pendingCursorLine` state
- `CommandPalette` loads templates on open, shows "New from Template: {name}" commands
- `Sidebar` plus button replaced with Radix dropdown menu: "Blank Note" + template list
- `Editor` consumes `pendingCursorLine` to position cursor at `{{cursor}}` location after template creation
- New `TemplateIcon` SVG icon added to icons index

### Templates
- **Daily Journal**: Sections for date, gratitude, goals, notes, reflection
- **Meeting Notes**: Date/time/attendees, agenda, discussion, action items
- **Project Brief**: Title, overview, goals, scope, timeline table, resources, risks table

### Design Decisions
- Templates are plain `.md` files in `.scratch/templates/` -- users can edit directly in any text editor
- Built-in templates only written if file doesn't exist, so user edits are preserved
- Variable substitution happens server-side in Rust for consistency and security
- Date formatting uses manual calculation (no chrono dep) to keep binary small
- Template system is generic enough to support database row templates (S-0003-12)

## Activity Log

| Date | Event | Details |
|------|-------|---------|
| 2026-02-13 | Created | Story added to E-0003 roadmap |
| 2026-02-13 | Started | Implementation started by claude |
| 2026-02-13 | Design | Backend template commands, frontend service layer, command palette + sidebar integration |
| 2026-02-13 | Done | All 7 acceptance criteria implemented and verified |
