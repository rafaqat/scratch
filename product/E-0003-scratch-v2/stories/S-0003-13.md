---
id: S-0003-13
title: "Webhook receiver"
status: Done
estimate_points: 3
tags: [mcp, plugins, backend]
owner: "claude"
created_at: "2026-02-13"
started_at: "2026-02-13"
completed_at: "2026-02-13"
target_version: ""
commits: []
links:
  epic: E-0003-scratch-v2
---

[← Roadmap](../README.md) · MCP Plugins · **1 of 3**
Prev feature: [← S-0003-12](S-0003-12.md) · Next: [S-0003-14 →](S-0003-14.md)

---

HTTP endpoint that accepts POST webhooks and creates/updates notes.

## Acceptance Criteria

- [x] `POST /webhooks/{plugin-name}` endpoint on MCP server
- [x] Configurable webhook handlers in `.scratch/plugins/`
- [x] Handler defines: trigger conditions, note creation/update rules, field mapping
- [x] Webhook payload accessible as variables in templates
- [x] Secret-based authentication (per-webhook shared secret)
- [x] Webhook activity log viewable in settings

## Technical Notes

Add routes to the existing Axum server in `src-tauri/src/mcp.rs`. Handler config is YAML:
```yaml
# .scratch/plugins/github-webhook.yaml
webhook:
  path: github
  secret: ${GITHUB_WEBHOOK_SECRET}
  on:
    issues.opened:
      action: create_note
      folder: github-issues
      template: |
        # {{payload.issue.title}}
        {{payload.issue.body}}
```


## Results

### Files Modified
- `src-tauri/src/webhooks.rs` — New module: webhook handler with YAML config loading, HMAC-SHA256 auth, template rendering, event routing, activity logging
- `src-tauri/src/mcp.rs` — Added `POST /webhooks/{plugin_name}` route to Axum server
- `src-tauri/src/lib.rs` — Registered `webhooks` module, added `webhook_get_log` Tauri command
- `src/types/note.ts` — Added `WebhookLogEntry` type
- `src/components/settings/McpSettingsSection.tsx` — Added webhook activity log viewer UI

### Key Design Decisions
- HMAC-SHA256 implemented without extra crate dependencies (pure Rust SHA-256 + HMAC)
- Template rendering uses `{{payload.field.path}}` syntax with dotted JSON path traversal
- Event detection supports GitHub-style `X-GitHub-Event` header + `action` field, plus generic `event`/`type` payload fields
- Activity log capped at 200 entries, stored as JSON in `.scratch/plugins/webhook-log.json`
- Secrets support `${ENV_VAR}` expansion for secure configuration

## Activity Log

| Date | Event | Details |
|------|-------|---------|
| 2026-02-13 | Created | Story added to E-0003 roadmap |
| 2026-02-13 | Started | Assigned to claude, implementation begun |
| 2026-02-13 | Design | Webhook receiver will add POST /webhooks/{plugin} route to existing Axum server. YAML configs in .scratch/plugins/ define handlers with secret auth, event routing, and Handlebars-style templates for note creation/update. Activity log stored in .scratch/plugins/webhook-log.json. |
| 2026-02-13 | Implemented | All 6 acceptance criteria completed. Rust webhook module with HMAC auth, template rendering, event routing. Frontend webhook log viewer in settings. |
| 2026-02-13 | Done | All criteria verified, compilation clean (excluding pre-existing database.rs error) |
