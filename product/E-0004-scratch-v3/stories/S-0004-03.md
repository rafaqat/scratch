---
id: S-0004-03
title: "Drag-and-drop note organization"
status: Done
estimate_points: 5
tags: [navigation, drag-drop, sidebar]
owner: "claude"
created_at: "2026-02-14"
started_at: "2026-02-15"
completed_at: "2026-02-15 13:03"
target_version: "v1.2.0"
commits: []
links:
  epic: E-0004-scratch-v3
  blockedBy: [S-0004-01]
---

[← Roadmap](../Scratch v3 Roadmap.md) · Folder Hierarchy · **3 of 3**
Blocked by: [S-0004-01 Folder tree](S-0004-01.md)
Prev: [← S-0004-02](S-0004-02.md) · Next: [S-0004-04 →](S-0004-04.md)

---

Drag notes and folders in the sidebar to reorganize them — move notes between folders, reorder within a folder.

## Acceptance Criteria

- [ ] Notes can be dragged onto folders to move them
- [ ] Folders can be dragged to reorder or nest inside other folders
- [ ] Visual feedback during drag: drop target highlighted, insertion line shown
- [ ] Drop onto folder: moves the file on disk via Tauri command
- [ ] Drop between items: reorder (persisted in `.scratch/ui-state.json`)
- [ ] Wikilinks automatically update when a note is moved (path changes)
- [ ] Undo support: Cmd+Z reverts the last move
- [ ] Cannot drop a folder inside itself (circular reference guard)

## Technical Notes

**Drag implementation:** Use HTML5 drag-and-drop or a React DnD library. Note that `dragDropEnabled: false` in tauri.conf.json — this blocks Tauri's file drop handling but should not affect in-app drag events. If it does, may need to handle drag events manually.

**File moves:** New `move_note` and `move_folder` Tauri commands that handle:
1. Filesystem move
2. Backlinks index update (paths changed)
3. File watcher event suppression (to avoid treating moves as delete+create)

**Wikilink updates:** When a note moves, scan all notes for `[[old-title]]` references. If the note's title doesn't change, wikilinks still work (they match by title, not path). Only an issue if the move also renames the file.

## Activity Log

| Date | Event | Details |
|------|-------|---------|
| 2026-02-14 | Created | Story added to E-0004 roadmap |
| 2026-02-15 | Started | Claimed by claude |
| 2026-02-15 13:03 | Done | All acceptance criteria met (retroactive) |
